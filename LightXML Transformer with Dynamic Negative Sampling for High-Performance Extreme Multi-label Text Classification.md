# LightXML: Transformer with Dynamic Negative Sampling for High-Performance Extreme Multi-label Text Classification

## LightXML：用于高性能极端多标签文本分类的动态负采样转换器

极端多标签文本分类（XMC）是一项从大型标签集中查找最相关标签的任务。如今，基于深度学习的方法在XMC中取得了巨大的成功。然而，现有的方法（如AttentionXML和X-Transformer等）仍然存在以下问题：1）组合多个模型对一个数据集进行训练和预测；2）在训练标签排序模型的过程中静态地采样负面标签，这降低了模型的效率和准确性。为了解决上述问题，我们提出了LightXML，它采用端到端训练和动态负标签采样。在LightXML中，我们使用生成式协作网络对标签进行召回和排序，其中标签召回部分生成负标签和正标签，标签排序部分从这些标签中区分正标签。通过这些网络，在标签排序部分训练期间，通过输入相同的文本表示动态地对负标签进行采样。大量实验表明，LightXML在五个极端的多标签数据集上的性能优于最先进的方法，具有更小的模型大小和更低的计算复杂度。特别是，在带有670K标签的Amazon数据集上，LightXML可以将模型大小比AttentionXML减少72%。



提出了一种新的深度学习方法，该方法将强大的变压器模型与生成式合作网络相结合。该方法通过端到端的训练，充分发挥transformer模型的优势。

我们提出了动态负抽样方法，利用生成式合作网络对标签进行召回和排序。动态负采样允许标签排序部分从易到难学习，避免过度拟合，从而提高整体模型性能。

我们的大量实验表明，在五个基准数据集上，我们的模型取得了所有方法中最好的结果。相比之下，我们的模型比目前最先进的方法具有更小的模型尺寸和更低的计算复杂度。

![image-20211016165423189](C:\Users\liqi\AppData\Roaming\Typora\typora-user-images\image-20211016165423189.png)

建议的框架如图1所示。首先利用标签的稀疏特征对标签进行聚类。标签聚类后，我们有一定数量的标签聚类，每个标签属于一个标签聚类。然后利用变换器模型将原始文本信息嵌入到高维表示中，作为标签检索部分和标签排序部分的输入。对于标签召回部分和标签排序部分，利用动态负采样的优势，提出了XMC的生成式协作网络。标签召回部分是这些网络的生成器，它可以动态地对负面标签进行采样。标签排序部分是这些网络的鉴别器，用于区分负标签和正标签。对于这些网络的操作，生成器帮助鉴别器学习更好的标签表示，并且鉴别器帮助生成器考虑细粒度文本信息。因为鉴别器是根据特定的标签而不是标签聚类来训练的。具体来说，对于生成器，我们通过文本表示对每个标签进行聚类，以获得top-K标签聚类，这是我们采样的标签。在训练阶段，所有正标签都被添加到该子集中，以使鉴别器可以使用生成器进行微调。对于鉴别器，将对该标签子集中的每个标签进行评分，以区分正标签和负标签。

![image-20211016175149287](C:\Users\liqi\AppData\Roaming\Typora\typora-user-images\image-20211016175149287.png)

详细的数据集统计。Ntrain是训练样本数，Ntesti是测试样本数，Dis是弓特征向量的维数，Lis是标签数，'Lis是每个样本的平均标签数，ˆLis是每个标签的平均样本数，“'wtrain”是每个训练样本的平均字数，“wtest”是每个测试样本的平均字数。

![image-20211016175304850](C:\Users\liqi\AppData\Roaming\Typora\typora-user-images\image-20211016175304850.png)

不同方法的比较。将我们的模型与Eurlex-4K、AmazonCat-13K、Wiki10-31K、Wiki-500K和Amazon-670K上最先进的XMC方法进行比较。请注意，XML-CNN在Wiki-500K上是不可扩展的，而且亚马逊-670K上的X-Transformer的结果从未被报告过，但由于硬件条件的限制，很难重现。

https://arxiv.org/pdf/2101.03305.pdf

代码可在[http://github. com/kongds/LightXML](http://github. com/kongds/LightXML)。